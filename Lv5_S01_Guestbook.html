<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>5ë‹¨ê³„ 1ê°•: ë°©ëª…ë¡ ë§Œë“¤ê¸°</title>
    
    <!-- React & ReactDOM -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/@phosphor-icons/web"></script>
    <link href="https://fonts.googleapis.com/css2?family=Jua&family=Noto+Sans+KR:wght@400;700&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Noto Sans KR', sans-serif; background-color: #fff7ed; }
        .kids-font { font-family: 'Jua', sans-serif; }
        .note-paper {
            background-image: linear-gradient(#e5e7eb 1px, transparent 1px);
            background-size: 100% 1.5rem;
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect } = React;

        const App = () => {
            const [messages, setMessages] = useState([]);
            const [input, setInput] = useState("");
            const [name, setName] = useState("");

            // 1. ì²˜ìŒ ì¼œì§ˆ ë•Œ ì €ì¥ëœ ë°ì´í„° ë¶ˆëŸ¬ì˜¤ê¸° (DB ì½ê¸° ì‹œë®¬ë ˆì´ì…˜)
            useEffect(() => {
                const saved = localStorage.getItem("myGuestbook");
                if (saved) {
                    setMessages(JSON.parse(saved));
                }
            }, []);

            // 2. ë©”ì‹œì§€ ì¶”ê°€í•˜ê¸° (DB ì“°ê¸° ì‹œë®¬ë ˆì´ì…˜)
            const addMessage = () => {
                if (!input || !name) return alert("ì´ë¦„ê³¼ ë‚´ìš©ì„ ëª¨ë‘ ì¨ì£¼ì„¸ìš”!");
                
                const newMsg = { id: Date.now(), name, text: input, date: new Date().toLocaleTimeString() };
                const updatedList = [newMsg, ...messages];
                
                setMessages(updatedList);
                localStorage.setItem("myGuestbook", JSON.stringify(updatedList)); // ì˜êµ¬ ì €ì¥
                setInput("");
            };

            // 3. ë©”ì‹œì§€ ì‚­ì œí•˜ê¸° (DB ì‚­ì œ ì‹œë®¬ë ˆì´ì…˜)
            const deleteMessage = (id) => {
                const updatedList = messages.filter(msg => msg.id !== id);
                setMessages(updatedList);
                localStorage.setItem("myGuestbook", JSON.stringify(updatedList));
            };

            return (
                <div className="min-h-screen flex flex-col items-center py-8 px-4">
                    {/* í—¤ë” */}
                    <div className="w-full max-w-lg flex justify-between items-center mb-6">
                        <button onClick={() => window.location.href='index.html'} className="bg-white p-2 rounded-lg shadow text-orange-500 hover:bg-orange-50">
                            <i className="ph-bold ph-house text-xl"></i>
                        </button>
                        <div className="text-center">
                            <span className="text-xs bg-orange-200 text-orange-800 px-2 py-1 rounded-full font-bold">5ë‹¨ê³„ 1ê°•</span>
                            <h1 className="text-2xl font-bold text-gray-800 kids-font">ğŸ“ ì‚¬ë¼ì§€ì§€ ì•ŠëŠ” ë°©ëª…ë¡</h1>
                        </div>
                        <button onClick={() => window.location.href='Lv5_S02_Chat.html'} className="bg-orange-500 text-white p-2 rounded-lg shadow hover:bg-orange-600 font-bold text-sm">
                            ë‹¤ìŒê°•ì˜ <i className="ph-bold ph-arrow-right"></i>
                        </button>
                    </div>

                    {/* í•™ìŠµ ì„¤ëª… ì¹´ë“œ */}
                    <div className="w-full max-w-lg bg-orange-100 border-l-4 border-orange-500 p-4 mb-6 rounded-r-lg">
                        <h3 className="font-bold text-orange-800 flex items-center">
                            <i className="ph-fill ph-database text-xl mr-2"></i>
                            ë°ì´í„°ë² ì´ìŠ¤(DB)ë€?
                        </h3>
                        <p className="text-sm text-orange-700 mt-1">
                            ë³´í†µ ìƒˆë¡œê³ ì¹¨í•˜ë©´ ë‚´ìš©ì´ ë‹¤ ì§€ì›Œì§€ì§€ë§Œ, DBë¥¼ ì“°ë©´ ê³µì±…ì— ì ì€ ê²ƒì²˜ëŸ¼ <strong>ì˜ì›íˆ ë‚¨ì•„ìš”!</strong><br/>
                            ì•„ë˜ì— ê¸€ì„ ì“°ê³  <strong>ìƒˆë¡œê³ ì¹¨(F5)</strong>ì„ ëˆŒëŸ¬ë³´ì„¸ìš”. ê¸€ì´ ì‚´ì•„ìˆë‚˜ìš”?
                        </p>
                    </div>

                    {/* ë°©ëª…ë¡ ì•± ì˜ì—­ */}
                    <div className="w-full max-w-lg bg-white rounded-3xl shadow-xl overflow-hidden border-2 border-orange-200">
                        {/* ì…ë ¥ì°½ */}
                        <div className="p-6 bg-orange-50 border-b border-orange-100">
                            <div className="flex gap-2 mb-2">
                                <input 
                                    type="text" 
                                    placeholder="ì´ë¦„" 
                                    value={name}
                                    onChange={(e) => setName(e.target.value)}
                                    className="w-1/3 p-2 rounded-lg border border-orange-200 focus:outline-none focus:ring-2 focus:ring-orange-400"
                                />
                                <input 
                                    type="text" 
                                    placeholder="ë‚¨ê¸¸ ë§ì„ ì ì–´ë³´ì„¸ìš”!" 
                                    value={input}
                                    onChange={(e) => setInput(e.target.value)}
                                    onKeyPress={(e) => e.key === 'Enter' && addMessage()}
                                    className="w-2/3 p-2 rounded-lg border border-orange-200 focus:outline-none focus:ring-2 focus:ring-orange-400"
                                />
                            </div>
                            <button 
                                onClick={addMessage}
                                className="w-full bg-orange-500 text-white py-2 rounded-lg font-bold shadow hover:bg-orange-600 transition flex items-center justify-center gap-2"
                            >
                                <i className="ph-bold ph-pencil-simple"></i> ê¸°ë¡ ë‚¨ê¸°ê¸°
                            </button>
                        </div>

                        {/* ë¦¬ìŠ¤íŠ¸ ì˜ì—­ */}
                        <div className="h-80 overflow-y-auto note-paper p-4 relative">
                            {messages.length === 0 && (
                                <div className="text-center text-gray-400 mt-20">
                                    <i className="ph-duotone ph-notebook text-6xl mb-2"></i>
                                    <p>ì•„ì§ ë‚¨ê²¨ì§„ ê¸€ì´ ì—†ì–´ìš”.</p>
                                </div>
                            )}
                            {messages.map((msg) => (
                                <div key={msg.id} className="bg-yellow-50 p-3 mb-3 rounded-lg shadow-sm border border-yellow-200 flex justify-between items-start group">
                                    <div>
                                        <div className="flex items-center gap-2">
                                            <span className="font-bold text-gray-800">{msg.name}</span>
                                            <span className="text-xs text-gray-400">{msg.date}</span>
                                        </div>
                                        <p className="text-gray-700 mt-1 whitespace-pre-wrap">{msg.text}</p>
                                    </div>
                                    <button 
                                        onClick={() => deleteMessage(msg.id)}
                                        className="text-gray-300 hover:text-red-500 opacity-0 group-hover:opacity-100 transition"
                                    >
                                        <i className="ph-bold ph-trash"></i>
                                    </button>
                                </div>
                            ))}
                        </div>
                    </div>
                </div>
            );
        };
        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>